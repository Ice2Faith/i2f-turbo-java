<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- 1小时缓存过期 -->
  <meta http-equiv="Cache-Control" content="max-age=3600, public">
  <title>Ops Home</title>
  <script src="./lib/vue/vue-2.js"></script>
  <script src="./lib/moment/moment-2.24.0.js"></script>
  <script src="./lib/element-ui/element-ui-2.15.10.js"></script>
  <link rel="stylesheet" href="./lib/element-ui/element-ui-2.15.10.css"/>
  <link rel="stylesheet" href="./lib/element-ui/element-ui-2.15.10-icon.css"/>
  <link href="./lib/element-ui/fonts/element-icons.ttf"/>
  <link href="./lib/element-ui/fonts/element-icons.woff"/>

  <script src="./lib/axios/axios-1.1.3.min.js"></script>
  <script src="./lib/axios/qs.js"></script>
</head>
<body>
    <div id="app">
      <el-card shadow="never">
        <div slot="header">
          <span>Ops Home</span>
        </div>
        <el-row :gutter="15" v-loading="menuLoading">
          <el-col :span="6" v-for="item in displayMenus">
            <el-result  :title="item.title" style="border: solid 1px #777; border-radius: 5px;margin-bottom: 15px;">
              <template slot="icon">
                <a :href="item.href" target="_blank">
                    <i :class="item.icon||'el-icon-monitor'" style="font-size: 32px"></i>
                </a>
              </template>
              <template slot="subTitle">
                <span style="color: #777;">{{item.subTitle}}</span>
              </template>
              <template slot="extra">
                <a :href="item.href" target="_blank">
                  访问
                </a>
              </template>
            </el-result>
          </el-col>

        </el-row>
      </el-card>
    </div>
</body>

<script>
  window.app = new Vue({
    components: {},
    data() {
      return {
        menuLoading: false,
        menus:[

        ],
        additionalMenus:[
          {
            title: 'Aliyun Oss',
            subTitle: '阿里云 Oss 对象存储管理',
            icon: 'el-icon-files',
            href: './aliyun-oss/index.html',
            disabled: true
          },
          {
            title: 'MongoDB',
            subTitle: 'MongoDB 管理',
            icon: 'el-icon-collection',
            href: './mongodb/index.html',
            disabled: true
          }
        ],
        defaultMenus: [
          {
            title: 'Database',
            subTitle: '连接/操作数据库',
            icon: 'el-icon-coin',
            href: './datasource/index.html'
          },
          {
            title: 'Redis',
            subTitle: '连接/操作Redis缓存',
            icon: 'el-icon-connection',
            href: './redis/index.html'
          },
          {
            title: 'Host',
            subTitle: '连接/操作Host主机命令/文件',
            icon: 'el-icon-monitor',
            href: './host/index.html'
          },
          {
            title: 'Ssh',
            subTitle: '连接/操作SSH主机命令/文件',
            icon: 'el-icon-link',
            href: './ssh/index.html'
          },
          {
            title: 'Xxl Job',
            subTitle: '执行XXL-JOB任务',
            icon: 'el-icon-timer',
            href: './xxl-job/index.html'
          },
          {
            title: 'Application',
            subTitle: '获取应用信息与执行表达式脚本',
            icon: 'el-icon-mobile',
            href: './app/index.html'
          },
          {
            title: 'Aws S3',
            subTitle: 'Aws S3 Oss 对象存储管理',
            icon: 'el-icon-files',
            href: './aws-s3/index.html'
          },
          {
            title: 'Minio',
            subTitle: 'Minio Oss 对象存储管理',
            icon: 'el-icon-receiving',
            href: './minio/index.html'
          },
          {
            title: 'ElasticSearch',
            subTitle: 'ElasticSearch 搜索引擎管理',
            icon: 'el-icon-search',
            href: './elasticsearch/index.html',
            disabled: true
          },
        ]
      }
    },
    created() {

    },
    mounted() {
      this.onLoadMenus();
    },
    watch: {},
    computed: {
      displayMenus(){
        return this.menus.filter(e=>!e.disabled)
      }
    },
    methods: {
      onLoadMenus(){
        this.menuLoading=true;
        this.$axios({
          url: './menus',
          method: 'post',
          data:{}
        }).then(res=>{
          if (res.data.code == 200) {
            //console.log(res.data)
            let resp = res.data.data
            // console.log(resp)
            this.menus=[...resp,...this.additionalMenus]
          } else {
            this.$message.error(res.data.msg)
          }
        }).catch(err => {
          this.$message.error(err.errorMessage || err.message || '菜单获取失败')
        }).finally(()=>{
          if(this.menus.length==0){
            this.menus=[...this.defaultMenus,...this.additionalMenus]
          }
          this.menuLoading=false;
        })
      },
      onClickMenuItem(item){

      }
    }
  })
  let defaultConfig = {
    baseURL: './',
    timeout: 10 * 60 * 1000,
    responseType: 'json'
  }
  let request = axios.create(defaultConfig)
  window.app.$axios = request
  window.app.$mount('#app')
</script>
<style>

  .list-item {
    margin-top: 3px;
    border-bottom: solid 1px #777;
  }

  .list-item:hover {
    background: lightskyblue;
  }

  .checked-item {
    background: darkorange;
  }

  .scroller {
    height: 260px
  }

  a{
    color: dodgerblue;
    text-decoration: none;
  }

  a:link{
    color: dodgerblue;
  }

  a:visited{
    color: dodgerblue;
  }

  a:hover{
    color: coral;
  }

  a:active{
    color: dodgerblue;
  }



</style>
</html>